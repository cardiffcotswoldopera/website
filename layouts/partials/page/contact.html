<h1>Contact us</h1>
<p>We love to hear from venues, audience members, and creatives looking to work with us. Please don't hesitate to get in touch</p>
{{ if isset .Site.Params "contact_form_url"}}
<div id="contact_form">
    <form id="contact-form" action="{{.Site.Params.contact_form_url}}" method="post">
        <div id="name_fields">
            <div id="firstname_field" class="field_container">
            <label for="firstname">First name</label>
            <input type="text" id="firstname" name="firstname" required>
            </div>
            <div id="surname_field" class="field_container">
            <label for="surname">Last name</label>
            <input type="text" id="surname" name="surname" required>
            </div>
        </div>
        <div id="email_field" class="field_container">
            <label for="email">Email address</label>
            <input type="email" id="email" name="email" required>
        </div>
        <div id="message_field" class="field_container">
            <label for="firstname">Message</label>
            <textarea id="message" name="message" placeholder="Write your message here" required></textarea>
        </div>
        <div id="submit_form" class="field_container">
            <button id="btn_contact" class="btn" type="submit">Submit</button>
        </div>
    </form>

</div>
<h6>Or get in touch with us directly</h6>
{{else}}
<h6>Get in touch with us directly</h6>
{{ end }}
<div id="contact_methods">
    <div class="contact_icon">
        <div class="contact_circle">
            <a href="mailto:cardiffcotswoldopera@gmail.com"><i class="fa fa-envelope"></i></a></p>
        </div>
        <div class="contact_desc">
            <a href="mailto:cardiffcotswoldopera@gmail.com">Email</a></p>
        </div>
    </div>
    <div class="contact_icon">
        <div class="contact_circle">
            <a href="https://facebook.com/@cardiffoperagroup/?hr=1"><i class="fab fa-facebook"></i></a></p>
        </div>
        <div class="contact_desc">
            <a href="https://facebook.com/@cardiffoperagroup/?hr=1">Facebook</a></p>
        </div>
    </div>
    <div class="contact_icon">
        <div class="contact_circle">
            <a href="https://instagram.com/cardiffopera"><i class="fab fa-instagram"></i></a></p>
        </div>
        <div class="contact_desc">
            <a href="https://instagram.com/cardiffopera">Instagram</a></p>
        </div>
    </div>
</div>

<script>
    document.getElementById('contact-form').addEventListener('submit', function(e) {
    e.preventDefault(); // Stop the page from reloading
    
    const form = this;
    const button = document.getElementById('btn_contact');
    const container = document.getElementById('submit_form');
    const formData = new FormData(form);

    // Visual feedback: Disable button while processing
    button.disabled = true;
    button.innerText = 'Sending email...';

    // Send the request to your Apps Script URL
    fetch(form.action, {
        method: 'POST',
        body: formData,
        mode: 'no-cors' // Critical for Google Apps Script redirects
    })
    .then(() => {
        // With 'no-cors', we can't read the response body, 
        // but if it doesn't throw an error, it's safe to assume success.
        container.innerHTML = `
            <h5>Your message has been sent</h5>
            <p>Thank you for reaching out to us. We will get back to you as soon as possible</p>
        `;
    })
    .catch(error => {
        console.error('Error:', error);
        button.disabled = false;
        button.innerText = 'Subscribe';
        alert('Sorry, there was an error. Please try again later or <a href="mailto:cardiffcotswoldopera@gmail.com">email us</a> directly.');
    });
});
</script>